name = "overlap"
compatibility_date = "2026-01-15"
compatibility_flags = ["nodejs_compat"]

# Workers deployment - main entry point from Astro build
main = "dist/_worker.js/index.js"

# Static assets configuration
[assets]
directory = "dist"
binding = "ASSETS"

# D1 and KV bindings are NOT declared here.
# They are provisioned by deploy.json on first deploy and stored in the
# Cloudflare dashboard by database_id / namespace_id.
# Declaring them here by name causes auto-deploy to resolve to the wrong
# resource if the account has multiple Overlap deployments.

# Environment variables
[vars]
ENVIRONMENT = "production"

# Note: TEAM_ENCRYPTION_KEY must be set as a secret during setup

# Stale session detection runs on authenticated page loads (no cron needed).
# Astro's Cloudflare adapter doesn't export scheduled(), so cron triggers
# would produce "Handler does not export a scheduled() function" errors.

# Enable worker logs for debugging
[observability]
[observability.logs]
enabled = true
invocation_logs = true
